<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Dashboard ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f9f9f9; }
    h2 { margin-top: 0; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background-color: #0A1E49; color: white; }
    button { padding: 6px 10px; border-radius: 6px; cursor: pointer; }
    .edit-btn { background: orange; color: white; border: none; }
    .delete-btn { background: red; color: white; border: none; }
    .add-btn { background: green; color: white; border: none; margin-top: 10px; }
    input[type="text"], input[type="email"] { width: 100%; padding: 6px; margin-bottom: 10px; }
    .form-container { background: white; padding: 20px; border-radius: 10px; max-width: 400px; margin: auto; }
  </style>
</head>
<body>

<h2>üìã ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
<table>
  <thead>
    <tr>
      <th>‡∏£‡∏´‡∏±‡∏™</th>
      <th>‡∏ä‡∏∑‡πà‡∏≠ - ‡∏™‡∏Å‡∏∏‡∏•</th>
      <th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th>
      <th>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</th>
      <th>userIdLine</th>
      <th>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</th>
      <th>‡∏•‡∏ö</th>
    </tr>
  </thead>
  <tbody id="employeeTable"></tbody>
</table>

<div class="form-container">
  <h3>‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
  <input type="text" id="empId" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô">
  <input type="text" id="fullName" placeholder="‡∏ä‡∏∑‡πà‡∏≠ - ‡∏™‡∏Å‡∏∏‡∏•">
  <input type="text" id="position" placeholder="‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á">
  <input type="email" id="email" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•">
  <input type="text" id="userIdLine" placeholder="UserId ‡∏à‡∏≤‡∏Å LINE">
  <button class="add-btn" onclick="saveEmployee()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
  <p id="status"></p>
</div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyBOCnA32ir0bHOlfIOvJ_ltAj65A5DJSlk",
authDomain: "register-58eea.firebaseapp.com",
databaseURL: "https://register-58eea-default-rtdb.asia-southeast1.firebasedatabase.app",
projectId: "register-58eea",
storageBucket: "register-58eea.firebasestorage.app",
messagingSenderId: "629204385342",
appId: "1:629204385342:web:1d9c20a8b3f57269e09b6f",
measurementId: "G-FFLKXCZE64"  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const table = document.getElementById("employeeTable");

  async function loadEmployees() {
    const snapshot = await db.ref("employees").once("value");
    table.innerHTML = "";
    snapshot.forEach(child => {
      const d = child.val();
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${d.empId}</td>
        <td>${d.fullName}</td>
        <td>${d.position}</td>
        <td>${d.email}</td>
        <td>${d.userIdLine}</td>
        <td><button class="edit-btn" onclick="editEmp('${d.empId}')">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button></td>
        <td><button class="delete-btn" onclick="deleteEmp('${d.empId}')">‡∏•‡∏ö</button></td>
      `;
      table.appendChild(tr);
    });
  }

  async function saveEmployee() {
    const empId = document.getElementById("empId").value.trim();
    const fullName = document.getElementById("fullName").value.trim();
    const position = document.getElementById("position").value.trim();
    const email = document.getElementById("email").value.trim();
    const userIdLine = document.getElementById("userIdLine").value.trim();

    if (!empId || !fullName || !position || !email || !userIdLine) {
      document.getElementById("status").textContent = "‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô";
      return;
    }

    await db.ref("employees/" + empId).set({
      empId,
      fullName,
      position,
      email,
      userIdLine
    });

    document.getElementById("status").textContent = "‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢";
    clearForm();
    loadEmployees();
  }

  function editEmp(empId) {
    db.ref("employees/" + empId).once("value").then(snapshot => {
      const d = snapshot.val();
      document.getElementById("empId").value = d.empId;
      document.getElementById("fullName").value = d.fullName;
      document.getElementById("position").value = d.position;
      document.getElementById("email").value = d.email;
      document.getElementById("userIdLine").value = d.userIdLine;
    });
  }

  async function deleteEmp(empId) {
    const confirmDel = confirm(`‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏£‡∏´‡∏±‡∏™ ${empId} ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`);
    if (confirmDel) {
      await db.ref("employees/" + empId).remove();
      loadEmployees();
    }
  }

  function clearForm() {
    document.getElementById("empId").value = "";
    document.getElementById("fullName").value = "";
    document.getElementById("position").value = "";
    document.getElementById("email").value = "";
    document.getElementById("userIdLine").value = "";
    document.getElementById("status").textContent = "";
  }

  loadEmployees();
</script>

</body>
</html>
